{
    "contents" : "resize.win <- function(Width=5, Height=3) #default for chi intended use paper\n{\n  # works for windows\n  dev.off(); # dev.new(width=6, height=6)\n  windows(record=TRUE, width=Width, height=Height)\n}\nresize.win()\n\nIsOutlier = function(trialTime, mean, sd){\n  max = mean+sd*3\n  min = mean-sd*3\n  return(trialTime > max | trialTime < min);\n}\n\nIsError = function(value){\n  return(value == 'Correct' & 1)\n}\n\nsummary<- read.csv(\"C:/Users/sarahms/Dropbox/Research/Projects/CHI 2015/Glissando Data/Analysis/SUMMARY_NO.csv\")\nsummary$IsError = ifelse(summary$Outcome=='Correct', 0, 1)\nsummaryBy(IsError~Condition+Participant,data=summary, FUN = function(x) { c(eRate = sum(x)/25)}) \nsummary <- subset(summary, Outcome == \"Correct\")\nsummaryF <- subset(summary, Trial == \"First\")\nsummaryR <- subset(summary, Trial == \"Return\")\n\nsummaryF$IsError = ifelse(summaryF$Outcome=='Correct', 0, 1)\nt = summaryBy(IsError~Condition+Participant+Gesture,data=summaryF, FUN = function(x) { c(eRate = sum(x)/5)}) \nfit = aov(IsError.eRate~Condition*Gesture,data=t)\nsummary(fit)\n\n\nt = summaryBy(IsError~Condition+Participant,data=summaryR, FUN = function(x) { c(eRate = sum(x)/25)}) \nt =  subset(t, Participant != 43)\nfit = aov(IsError.eRate~Condition,data=t)\nsummary(fit)\nsummaryBy(IsError.eRate~Condition, dat=t)\nggplot(t, aes(x=Condition, y=IsError.eRate)) + geom_boxplot()+theme_bw()\n\n\ntrialTimes = summaryBy(Difference~Gesture,data=summaryF, FUN = function(x) { c(m = mean(x), s = sd(x))}) \nsummaryF$outlier = trialTimes$Difference.m[match(summaryF$Gesture,trialTimes$Gesture)]\nsummaryF$outlier2 = trialTimes$Difference.s[match(summaryF$Gesture,trialTimes$Gesture)]\n\nsummaryF$Filter = IsOutlier(summaryF$Difference, summaryF$outlier, summaryF$outlier2);\nnumberOfOutliers = nrow(summaryF[which(summaryF$Filter==1),]);\nnumberOfOutliers;\nsummaryF = summaryF[which(summaryF$Filter==0),]\n\ntrialTimes = summaryBy(Difference~Gesture,data=summaryR, FUN = function(x) { c(m = mean(x), s = sd(x))}) \nsummaryR$outlier = trialTimes$Difference.m[match(summaryR$Gesture,trialTimes$Gesture)]\nsummaryR$outlier2 = trialTimes$Difference.s[match(summaryR$Gesture,trialTimes$Gesture)]\n\nsummaryR$Filter = IsOutlier(summaryR$Difference, summaryR$outlier, summaryR$outlier2);\nnumberOfOutliers = nrow(summaryR[which(summaryR$Filter==1),]);\nnumberOfOutliers;\nsummaryR = summaryR[which(summaryR$Filter==0),]\n\n\nsumsumF <- summaryBy(Difference~Gesture+Participant+Trial+Condition,data=summaryF, keep.names=TRUE)\ntrialTimes = summaryBy(Difference~Gesture,data=sumsumF, FUN = function(x) { c(m = mean(x), s = sd(x))}) \n\nsumsumF$outlier = trialTimes$Difference.m[match(sumsumF$Gesture,trialTimes$Gesture)]\nsumsumF$outlier2 = trialTimes$Difference.s[match(sumsumF$Gesture,trialTimes$Gesture)]\n\nsumsumF$Filter = IsOutlier(sumsumF$Difference, sumsumF$outlier, sumsumF$outlier2);\nnumberOfOutliers = nrow(sumsumF[which(sumsumF$Filter==1),]);\nnumberOfOutliers;\nsumsumF = sumsumF[which(sumsumF$Filter==0),]\nsumsumF = sumsumF[which(sumsumF$Participant != 8 & sumsumF$Participant != 10),]\nsumsumF$Difference = sumsumF$Difference/1000000\ng = ggplot(sumsumF, aes(x=Gesture, y=Difference, fill=Condition)) + geom_boxplot()+theme_bw()\ng\nggsave(\"Boxplot_F.png\", dpi=300)\n\nsumsumR <- summaryBy(Difference~Gesture+Participant+Trial+Condition,data=summaryF, keep.names=TRUE)\n\ntrialTimes = summaryBy(Difference~Gesture,data=sumsumR, FUN = function(x) { c(m = mean(x), s = sd(x))}) \n\nsumsumR$outlier = trialTimes$Difference.m[match(sumsumR$Gesture,trialTimes$Gesture)]\nsumsumR$outlier2 = trialTimes$Difference.s[match(sumsumR$Gesture,trialTimes$Gesture)]\n\nsumsumR$Filter = IsOutlier(sumsumR$Difference, sumsumR$outlier, sumsumR$outlier2);\nnumberOfOutliers = nrow(sumsumR[which(sumsumR$Filter==1),]);\nnumberOfOutliers;\nsumsumR = sumsumR[which(sumsumR$Filter==0),]\nggplot(sumsumR, aes(x=Gesture, y=Difference, fill=Condition)) + geom_boxplot()+theme_bw()\ng\nggsave(\"Boxplot_R.png\", dpi=300)\n\n\nsummaryFsum <- summarySE(sumsumF, measurevar=\"Difference\", groupvars=c(\"Condition\",\"Gesture\"))\nggplot(summaryFsum, aes(x=Gesture, y=Difference, fill=Condition)) + \n  geom_bar(position=position_dodge(), stat=\"identity\") +\n  ggtitle(\"\") +\n  geom_errorbar(aes(ymin=Difference-se, ymax=Difference+se),\n                width=.2,                    # Width of the error bars\n                position=position_dodge(.9)) + theme_bw()\nggsave(\"Bar_F.png\", dpi=300)\n\n\nsummaryRsum <- summarySE(sumsumR, measurevar=\"Difference\", groupvars=c(\"Condition\",\"Gesture\"))\nggplot(summaryRsum, aes(x=Gesture, y=Difference, fill=Condition)) + \n  geom_bar(position=position_dodge(), stat=\"identity\") +\n  ggtitle(\"\") +\n  geom_errorbar(aes(ymin=Difference-se, ymax=Difference+se),\n                width=.2,                    # Width of the error bars\n                position=position_dodge(.9)) + theme_bw()\nggsave(\"Bar_R.png\", dpi=300)\n\nfit = aov(Difference ~ Condition*Gesture, data=sumsumF)\nsummary.aov(fit)\nTukeyHSD(fit)\naov = ezANOVA(data=sumsumF, dv=Difference, between=.(Condition,Gesture), wid=Participant, return_aov=TRUE, detailed=TRUE)\naov\n\n\nfit = aov(Difference ~ Condition*Gesture, data=sumsumR)\nsummary.aov(fit)\nTukeyHSD(fit)\naov = ezANOVA(data=sumsumR, dv=Difference, between=.(Condition,Gesture), wid=Participant, return_aov=TRUE, detailed=TRUE)\naov\n\nsummary<- read.csv(\"C:/Users/sarahms/Dropbox/Research/Projects/CHI 2015/Glissando Data/Analysis/SUMMARY_NO.csv\")\n\n\n",
    "created" : 1411142052130.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4173958048",
    "id" : "4FA0B877",
    "lastKnownWriteTime" : 1410883376,
    "path" : "C:/Users/sarahms/Dropbox/Research/Projects/CHI 2015/Glissando Data/Analysis/newscript.R",
    "project_path" : "newscript.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}