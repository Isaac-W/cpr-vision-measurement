{
    "contents" : "---\ntitle: \"Glissando CHI 2015\"\nauthor: \"Jaime Ruiz\"\ndate: \"Friday, September 19, 2014\"\noutput: html_document\n---\n\nLibraries\n------------------\n```{r, results=\"hide\", message=FALSE}\nlibrary(doBy);\nlibrary(ggplot2);\nlibrary(nlme);\nlibrary(car); #needed for ANOVA function\nrequire(multcomp)\n```\n\n### Functions\n\n```{r, echo=FALSE}\nIsOutlier = function(trialTime, mean, sd){\n  max = mean+sd*3\n  min = mean-sd*3\n\treturn(trialTime > max | trialTime < min);\n}\n## Summarizes data.\n## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).\n## If there are within-subject variables, calculate adjusted values using method from Morey (2008).\n##   data: a data frame.\n##   measurevar: the name of a column that contains the variable to be summariezed\n##   groupvars: a vector containing names of columns that contain grouping variables\n##   na.rm: a boolean that indicates whether to ignore NA's\n##   conf.interval: the percent range of the confidence interval (default is 95%)\nsummarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE, conf.interval=.95) {\n    require(doBy)\n\n    # New version of length which can handle NA's: if na.rm==T, don't count them\n    length2 <- function (x, na.rm=FALSE) {\n        if (na.rm) sum(!is.na(x))\n        else       length(x)\n    }\n\n    # Collapse the data\n    formula <- as.formula(paste(measurevar, paste(groupvars, collapse=\" + \"), sep=\" ~ \"))\n    datac <- summaryBy(formula, data=data, FUN=c(length2,mean,sd), na.rm=na.rm)\n\n    # Rename columns\n    names(datac)[ names(datac) == paste(measurevar, \".mean\",    sep=\"\") ] <- measurevar\n    names(datac)[ names(datac) == paste(measurevar, \".sd\",      sep=\"\") ] <- \"sd\"\n    names(datac)[ names(datac) == paste(measurevar, \".length2\", sep=\"\") ] <- \"N\"\n    \n    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean\n    \n    # Confidence interval multiplier for standard error\n    # Calculate t-statistic for confidence interval: \n    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1\n    ciMult <- qt(conf.interval/2 + .5, datac$N-1)\n    datac$ci <- datac$se * ciMult\n    \n    return(datac)\n}\n## Norms the data within specified groups in a data frame; it normalizes each\n## subject (identified by idvar) so that they have the same mean, within each group\n## specified by betweenvars.\n##   data: a data frame.\n##   idvar: the name of a column that identifies each subject (or matched subjects)\n##   measurevar: the name of a column that contains the variable to be summariezed\n##   betweenvars: a vector containing names of columns that are between-subjects variables\n##   na.rm: a boolean that indicates whether to ignore NA's\nnormDataWithin <- function(data=NULL, idvar, measurevar, betweenvars=NULL, na.rm=FALSE) {\n    require(doBy)\n    \n    # Measure var on left, idvar + between vars on right of formula.\n    subjMeanFormula <- as.formula(paste(measurevar, paste(c(idvar, betweenvars), collapse=\" + \"), sep=\" ~ \"))\n    data.subjMean   <- summaryBy(subjMeanFormula, data=data, keep.names=TRUE, na.rm=na.rm)\n    names(data.subjMean)[names(data.subjMean) == measurevar] <- \"subjMean\"\n\n    # Put the subject means with original data\n    data <- merge(data, data.subjMean)\n    \n    # Get the normalized data in a new column\n    measureNormedVar <- paste(measurevar, \"Normed\", sep=\"\")\n    data[,measureNormedVar] <- data[,measurevar] - data[,\"subjMean\"] + mean(data[,measurevar])\n\n    # Remove this subject mean column\n    data$subjMean <- NULL\n    \n    return(data)\n}\n## Summarizes data, handling within-subjects variables by removing inter-subject variability.\n## It will still work if there are no within-S variables.\n## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).\n## If there are within-subject variables, calculate adjusted values using method from Morey (2008).\n##   data: a data frame.\n##   measurevar: the name of a column that contains the variable to be summariezed\n##   betweenvars: a vector containing names of columns that are between-subjects variables\n##   withinvars: a vector containing names of columns that are within-subjects variables\n##   idvar: the name of a column that identifies each subject (or matched subjects)\n##   na.rm: a boolean that indicates whether to ignore NA's\n##   conf.interval: the percent range of the confidence interval (default is 95%)\nsummarySEwithin <- function(data=NULL, measurevar, betweenvars=NULL, withinvars=NULL, idvar=NULL, na.rm=FALSE, conf.interval=.95) {\n    # Norm each subject's data    \n    data <- normDataWithin(data, idvar, measurevar, betweenvars, na.rm)\n    \n    # This is the name of the new column\n    measureNormedVar <- paste(measurevar, \"Normed\", sep=\"\")\n    \n    # Replace the original data column with the normed one\n    data[,measurevar] <- data[,measureNormedVar]\n    \n\n    # Collapse the normed data - now we can treat between and within vars the same\n    datac <- summarySE(data, measurevar, groupvars=c(betweenvars, withinvars), na.rm=na.rm, conf.interval=conf.interval)\n\n\n    # Apply correction from Morey (2008) to the standard error and confidence interval\n    #  Get the product of the number of conditions of within-S variables\n    nWithinGroups    <- prod(sapply(datac[,withinvars, drop=FALSE], FUN=nlevels))\n    correctionFactor <- sqrt( nWithinGroups / (nWithinGroups-1) )\n\n    # Apply the correction factor\n    datac$sd <- datac$sd * correctionFactor\n    datac$se <- datac$se * correctionFactor\n    datac$ci <- datac$ci * correctionFactor\n\n    return(datac)\n}\n\nresize.win <- function(Width=5, Height=3) #default for chi intended use paper\n{\n  # works for windows\n  dev.off(); # dev.new(width=6, height=6)\n  windows(record=TRUE, width=Width, height=Height)\n}\n\n# The palette with grey:\ncbPalette <- c(\"#999999\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\")\n\n# The palette with black:\ncbbPalette <- c(\"#000000\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\")\n\nbrewerPalette = c(\"#ffeda0\", \"#f03b20\")\n\nIsError = function(value){\n  return(value == 'Correct' & 1)\n}\n```\n\nRead File\n-------------------------\n```{r}\nsummary<- read.csv(\"D:/Dropbox/Sarah's Dropbox/CHI 2015/Glissando Data/Analysis/SUMMARY_NO.csv\")\nnames(summary)\n```\n\nExamine Error Rate\n------------------------\n```{r, echo=FALSE}\n#Setup\nsummary$IsError = ifelse(summary$Outcome=='Correct', 0, 1)\n\n# 1. Look at error rate\nsummaryF <- subset(summary, Trial == \"First\")\nsummaryR <- subset(summary, Trial == \"Return\")\n```\n\n### First Study Error Rate\n\n#### Means\n```{r}\nsummaryF$IsError = ifelse(summaryF$Outcome=='Correct', 0, 1)\nt = summaryBy(IsError~Condition+Participant+Gesture,data=summaryF, FUN = function(x) { c(eRate = sum(x)/5)}) \nsummaryBy(IsError.eRate~Condition, data=t, FUN = function(x) { c(m = mean(x), s = sd(x))})\n\n```\n#### Anova\n```{r}\nfit = aov(IsError.eRate~Condition*Gesture,data=t)\nsummary(fit)\n```\n\n### Second Study Error Rate\n\n#### Means\n```{r}\nsummaryR$IsError = ifelse(summaryR$Outcome=='Correct', 0, 1)\nt = summaryBy(IsError~Condition+Participant+Gesture,data=summaryR, FUN = function(x) { c(eRate = sum(x)/5)}) \nsummaryBy(IsError.eRate~Condition, data=t, FUN = function(x) { c(m = mean(x), s = sd(x))})\n```\n\n#### Anova\n```{r}\nfit = aov(IsError.eRate~Condition*Gesture,data=t)\nsummary(fit)\nTukeyHSD(fit)\n```\n\nGesture Error\n------------------------\n\n#### Setup\n```{r, echo=FALSE}\n#Filter out errors\nsummary <- subset(summary, Outcome == \"Correct\")\nsummaryF <- subset(summary, Trial == \"First\")\nsummaryR <- subset(summary, Trial == \"Return\")\n\ntrialTimes = summaryBy(Difference~Gesture,data=summaryF, FUN = function(x) { c(m = mean(x), s = sd(x))}) \nsummaryF$outlier = trialTimes$Difference.m[match(summaryF$Gesture,trialTimes$Gesture)]\nsummaryF$outlier2 = trialTimes$Difference.s[match(summaryF$Gesture,trialTimes$Gesture)]\n\nsummaryF$Filter = IsOutlier(summaryF$Difference, summaryF$outlier, summaryF$outlier2);\nnumberOfOutliers = nrow(summaryF[which(summaryF$Filter==1),]);\nprint(\"Number of outliers in First Study\")\nnumberOfOutliers;\nsummaryF = summaryF[which(summaryF$Filter==0),]\n\ntrialTimes = summaryBy(Difference~Gesture,data=summaryR, FUN = function(x) { c(m = mean(x), s = sd(x))}) \nsummaryR$outlier = trialTimes$Difference.m[match(summaryR$Gesture,trialTimes$Gesture)]\nsummaryR$outlier2 = trialTimes$Difference.s[match(summaryR$Gesture,trialTimes$Gesture)]\n\nsummaryR$Filter = IsOutlier(summaryR$Difference, summaryR$outlier, summaryR$outlier2);\nnumberOfOutliers = nrow(summaryR[which(summaryR$Filter==1),]);\nprint(\"Number of outliers in Return Study\")\nnumberOfOutliers;\nsummaryR = summaryR[which(summaryR$Filter==0),]\n```\n\n### First Study\n\n```{r, echo=FALSE}\nsumsumF <- summaryBy(Difference~Gesture+Participant+Trial+Condition,data=summaryF, keep.names=TRUE)\ntrialTimes = summaryBy(Difference~Gesture,data=sumsumF, FUN = function(x) { c(m = mean(x), s = sd(x))}) \n\nsumsumF$outlier = trialTimes$Difference.m[match(sumsumF$Gesture,trialTimes$Gesture)]\nsumsumF$outlier2 = trialTimes$Difference.s[match(sumsumF$Gesture,trialTimes$Gesture)]\n\nsumsumF$Filter = IsOutlier(sumsumF$Difference, sumsumF$outlier, sumsumF$outlier2);\nnumberOfOutliers = nrow(sumsumF[which(sumsumF$Filter==1),]);\nprint(\"Number of OUtliers filtered\")\nnumberOfOutliers;\nsumsumF = sumsumF[which(sumsumF$Filter==0),]\nsumsumF = sumsumF[which(sumsumF$Participant != 8 & sumsumF$Participant != 10),]\nsumsumF$Difference = sumsumF$Difference/1000000\n```\n\n#### Means\n```{r, echo=FALSE}\nsummaryBy(Difference~Gesture+Condition,data=sumsumF, keep.names=TRUE, FUN=c(mean,sd))\nsummaryBy(Difference~Condition,data=sumsumF, keep.names=TRUE, FUN=c(mean,sd))\n```\n\n#### Anova\n```{r, echo=FALSE}\nfit = aov(Difference ~ Condition*Gesture, data=sumsumF)\nsummary.aov(fit)\n\n```\n\n```{r, echo=FALSE}\nTukeyHSD(fit)\n```\n\n#### Graph\n```{r, echo=FALSE}\ng = ggplot(sumsumF, aes(x=Gesture, y=Difference, fill=Condition)) + \n  geom_boxplot()+theme_bw()+ scale_fill_manual(values=brewerPalette)+ \n  theme(legend.position=\"none\") +\n  ylab(\"Gesture Error (ms)\");\ng\nresize.win()\nggsave(\"Box_F_no_legend.png\", dpi=300)\n```\n\n```{r, echo=FALSE}\ng = ggplot(sumsumF, aes(x=Gesture, y=Difference, fill=Condition)) + geom_boxplot()+theme_bw()+ scale_fill_manual(values=brewerPalette)+ theme(legend.title = element_text( size=10, face=\"bold\"))+\n  ylab(\"Gesture Error (ms)\");\ng\nresize.win()\nggsave(\"Box_F_legend.png\", dpi=300)\n\ng = ggplot(sumsumF, aes(x=Gesture, y=Difference, fill=Condition)) + geom_boxplot()+theme_bw()+ scale_fill_manual(values=brewerPalette)+ theme(legend.title = element_text( size=10, face=\"bold\"), legend.position=\"top\")+\n  ylab(\"Gesture Error (ms)\");\ng\nresize.win()\nggsave(\"Box_F_legend_top.png\", dpi=300)\n```\n\n### Return Study\n\n```{r, echo=FALSE}\nsumsumR <- summaryBy(Difference~Gesture+Participant+Trial+Condition,data=summaryR, keep.names=TRUE)\nsumsumR = sumsumR[which(sumsumR$Participant != 36 & sumsumR$Participant != 46 & sumsumR$Participant != 7),]\n\ntrialTimes = summaryBy(Difference~Gesture,data=sumsumR, FUN = function(x) { c(m = mean(x), s = sd(x))}) \n\nsumsumR$outlier = trialTimes$Difference.m[match(sumsumR$Gesture,trialTimes$Gesture)]\nsumsumR$outlier2 = trialTimes$Difference.s[match(sumsumR$Gesture,trialTimes$Gesture)]\n\nsumsumR$Filter = IsOutlier(sumsumR$Difference, sumsumR$outlier, sumsumR$outlier2);\nnumberOfOutliers = nrow(sumsumR[which(sumsumR$Filter==1),]);\nprint(\"Number of OUtliers filtered\")\nnumberOfOutliers;\n\nsumsumR$Difference = sumsumR$Difference/1000000\nsumsumR[which(sumsumR$Condition==\"Control\"),]$Difference = abs(sumsumR[which(sumsumR$Condition==\"Control\"),]$Difference)\n#sumsumR$Participant = as.factor(sumsumR$Participant)\n\n#ggplot(sumsumR[which(sumsumR$Condition==\"Glissando\"),], aes(x=Gesture, y=Difference)) + \n#  geom_boxplot()+theme_bw()+ scale_fill_manual(values=brewerPalette)+ \n#  theme(legend.position=\"none\") + facet_grid(Participant~.)\n#  ylab(\"Gesture Error (ms)\");\n```\n\n#### Means\n```{r, echo=FALSE}\nsummaryBy(Difference~Gesture+Condition,data=sumsumR, keep.names=TRUE, FUN=c(mean,sd))\nsummaryBy(Difference~Condition,data=sumsumR, keep.names=TRUE, FUN=c(mean,sd))\n```\n\n#### Anova\n```{r, echo=FALSE}\nfit = aov(Difference ~ Condition*Gesture, data=sumsumR)\nsummary.aov(fit)\n\n```\n\n```{r, echo=FALSE}\nTukeyHSD(fit)\n```\n\n#### Graph\n```{r, echo=FALSE}\ng = ggplot(sumsumR, aes(x=Gesture, y=Difference, fill=Condition)) + \n  geom_boxplot()+theme_bw()+ scale_fill_manual(values=brewerPalette)+ \n  theme(legend.position=\"none\") +\n  ylab(\"Gesture Error (ms)\");\ng\nresize.win()\nggsave(\"Box_R_no_legend.png\", dpi=300)\n```\n\n```{r, echo=FALSE}\ng = ggplot(sumsumR, aes(x=Gesture, y=Difference, fill=Condition)) + geom_boxplot()+theme_bw()+ scale_fill_manual(values=brewerPalette)+ theme(legend.title = element_text( size=10, face=\"bold\"))+\n  ylab(\"Gesture Error (ms)\");\ng\nresize.win()\nggsave(\"Box_R_legend.png\", dpi=300)\n\ng = ggplot(sumsumR, aes(x=Gesture, y=Difference, fill=Condition)) + geom_boxplot()+theme_bw()+ scale_fill_manual(values=brewerPalette)+ theme(legend.title = element_text( size=10, face=\"bold\"), legend.position=\"top\")+\n  ylab(\"Gesture Error (ms)\");\ng\nresize.win()\nggsave(\"Box_R_legend_top.png\", dpi=300)\n```\n",
    "created" : 1411155864432.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1083773172",
    "id" : "39CFC5C1",
    "lastKnownWriteTime" : 1411151543,
    "path" : "C:/Users/sarahms/Dropbox/Research/Projects/CHI 2015/Glissando Data/Analysis/Final Trial Analysis.rmd",
    "project_path" : "Final Trial Analysis.rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}